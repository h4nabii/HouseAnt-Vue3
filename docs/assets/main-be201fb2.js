import{_ as d,v as F,h as v,o as a,c as r,a as t,w as g,b as $,d as M,p as y,e as I,f as p,F as w,r as k,t as u,g as f,i as b,j as x,n as S,k as N,l as _,m as T,q as E,s as H}from"./plugin-vue_export-helper-1f930858.js";const j={emits:["login"],data(){return{form:{account:"",password:""}}},methods:{login(){if(!F(this.form.account,this.form.password)){console.log(">> invalid parameter");return}v.user.login(this.form.account,this.form.password).then(e=>{console.log(e),e.success?(console.log(">> login successfully"),this.$emit("login")):e.newUser?(console.log(">> failed: account not found, now trying to register a new account"),this.register(this.form.account,this.form.password)):e.error?console.log(">> error: "+e.message):console.log(">> error: unknown reason")})},register(e,s){v.user.register(e,s).then(o=>{this.msg=o.message,o.success&&(console.log(">> Register successfully, now trying to login"),this.login(this.form.account,this.form.password))})},clean_input(){this.form.account="",this.form.password=""},clean_msg(){this.msg=""}}},U=e=>(y("data-v-e85f487f"),e=e(),I(),e),O={class:"login-panel border-panel"},q=U(()=>t("div",{class:"title"},[p("登录 / 注册 "),t("i",null,"新账号将会自动注册")],-1)),z=U(()=>t("span",null,"账号：",-1)),G=U(()=>t("span",null,"密码：",-1));function J(e,s,o,c,i,l){return a(),r("div",O,[q,t("form",null,[t("label",null,[z,g(t("input",{class:"panel-input","onUpdate:modelValue":s[0]||(s[0]=n=>i.form.account=n),type:"text",onInput:s[1]||(s[1]=(...n)=>l.clean_msg&&l.clean_msg(...n))},null,544),[[$,i.form.account]])]),t("label",null,[G,g(t("input",{class:"panel-input","onUpdate:modelValue":s[2]||(s[2]=n=>i.form.password=n),type:"password",onInput:s[3]||(s[3]=(...n)=>l.clean_msg&&l.clean_msg(...n))},null,544),[[$,i.form.password]])]),t("button",{class:"panel-button",onClick:s[4]||(s[4]=M((...n)=>l.login&&l.login(...n),["prevent"])),type:"submit"},"登录")])])}const K=d(j,[["render",J],["__scopeId","data-v-e85f487f"]]),Q={props:["house"]},W={class:"border-panel"};function X(e,s,o,c,i,l){return a(),r("div",W,[t("ul",null,[(a(!0),r(w,null,k(o.house,n=>(a(),r("li",null,u(n),1))),256))])])}const A=d(Q,[["render",X]]),Y={props:["houses"],components:{SourceItem:A}};function Z(e,s,o,c,i,l){const n=f("SourceItem");return a(!0),r(w,null,k(o.houses,h=>(a(),b(n,{house:h},null,8,["house"]))),256)}const ee=d(Y,[["render",Z]]),se={data(){return{houses:[]}},components:{SourceList:ee,SourceItem:A},created(){v.houseOwner.getMyHouses().then(e=>{this.houses=e.houses})}},te={class:"owner-panel border-panel"},ne=t("div",{class:"title"},"我的房源",-1);function oe(e,s,o,c,i,l){const n=f("SourceList");return a(),r("div",te,[ne,x(n,{houses:i.houses},null,8,["houses"])])}const V=d(se,[["render",oe]]);function ie(e,s,o,c){return e===""?{success:!1,emptyUsername:!0}:s!==o?{success:!1,confirmFailed:!0}:{success:!0,changePass:s!==""}}const C="/houseant-front/assets/no-pic-f1d681f0.jpg";const le={emits:["update","changePass"],props:["username","tel"],data(){return{form:{avatar:"",username:"",password:"",confirm:"",tel:""},msg:{avatar:"",username:"",password:"",confirm:"",tel:""}}},methods:{updateInfo(){let e=this.form,s=this.msg;console.log(e);let o=ie(e.username,e.password,e.confirm,e.tel);o.success?v.user.updateInfo(e.username,e.password,e.tel).then(({success:c,keep:i,message:l})=>{c?(i?this.$emit("update"):this.$emit("changePass"),console.log(">> "+l)):console.log(">> failed: "+l)}):(o.emptyUsername&&(s.username="用户名不能为空"),o.confirmFailed&&(s.confirm="两次输入的密码不同"))},reset(){this.form.username=this.username,this.form.password="",this.form.confirm="",this.form.tel=this.tel,this.clearMsg("username"),this.clearMsg("password"),this.clearMsg("confirm"),this.clearMsg("tel")},clearMsg(e){this.msg[e]=""}},created(){this.reset()}},P=e=>(y("data-v-531994aa"),e=e(),I(),e),ae={class:"modify-panel border-panel"},re=P(()=>t("div",{class:"title"},"修改个人信息",-1)),ue=P(()=>t("label",{class:"avatar-input"},[t("img",{class:"avatar",src:C,alt:"avatar"}),t("input",{type:"file"})],-1)),ce={class:"base-input"},de={class:"input-line"},_e=P(()=>t("label",{for:"username-input"},"用户名：",-1)),pe={id:"username-msg"},fe={class:"input-line"},me=P(()=>t("label",{for:"password-input"},"密码：",-1)),he={id:"password-msg"},ve={class:"input-line"},ge=P(()=>t("label",{for:"confirm-input"},"确认密码：",-1)),$e={id:"confirm-msg"},be={class:"input-line"},ye=P(()=>t("label",{for:"tel-input"},"电话：",-1)),Ie={id:"tel-msg"},we={class:"button-bar"};function Pe(e,s,o,c,i,l){return a(),r("div",ae,[re,t("form",null,[ue,t("div",ce,[t("div",de,[_e,g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>i.form.username=n),onInput:s[1]||(s[1]=n=>l.clearMsg("username")),id:"username-input",class:"panel-input",type:"text"},null,544),[[$,i.form.username]]),t("span",pe,u(i.msg.username),1)]),t("div",fe,[me,g(t("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>i.form.password=n),onInput:s[3]||(s[3]=n=>l.clearMsg("password")),id:"password-input",class:"panel-input",type:"password"},null,544),[[$,i.form.password]]),t("span",he,u(i.msg.password),1)]),t("div",ve,[ge,g(t("input",{"onUpdate:modelValue":s[4]||(s[4]=n=>i.form.confirm=n),onInput:s[5]||(s[5]=n=>l.clearMsg("confirm")),id:"confirm-input",class:"panel-input",type:"password"},null,544),[[$,i.form.confirm]]),t("span",$e,u(i.msg.confirm),1)]),t("div",be,[ye,g(t("input",{"onUpdate:modelValue":s[6]||(s[6]=n=>i.form.tel=n),onInput:s[7]||(s[7]=n=>l.clearMsg("tel")),id:"tel-input",class:"panel-input",type:"tel"},null,544),[[$,i.form.tel]]),t("span",Ie,u(i.msg.tel),1)]),t("div",we,[t("button",{onClick:s[8]||(s[8]=M((...n)=>l.updateInfo&&l.updateInfo(...n),["prevent"])),class:"panel-button"},"确认修改"),t("button",{onClick:s[9]||(s[9]=M((...n)=>l.reset&&l.reset(...n),["prevent"])),class:"panel-button"},"重置")])])])])}const B=d(le,[["render",Pe],["__scopeId","data-v-531994aa"]]),xe={props:["reservation"]},ke={class:"border-panel"};function Le(e,s,o,c,i,l){return a(),r("div",ke,[t("ul",null,[(a(!0),r(w,null,k(o.reservation,n=>(a(),r("li",null,u(n),1))),256))])])}const Se=d(xe,[["render",Le]]),Me={props:["reservations"],components:{ReservationItem:Se}};function Ue(e,s,o,c,i,l){const n=f("ReservationItem");return a(!0),r(w,null,k(o.reservations,h=>(a(),b(n,{reservation:h},null,8,["reservation"]))),256)}const Ce=d(Me,[["render",Ue]]),De={components:{ReservationList:Ce},data(){return{reservations:[]}},created(){v.customer.getMyReservations().then(e=>{this.reservations=e.reservations})}},Ve={class:"source-panel border-panel"},Be=t("div",{class:"title"},"我的预约",-1);function Re(e,s,o,c,i,l){const n=f("ReservationList");return a(),r("div",Ve,[Be,x(n,{reservations:i.reservations},null,8,["reservations"])])}const R=d(De,[["render",Re]]);const Ae={components:{CustomerPanel:R,ModifyPanel:B,OwnerPanel:V},data(){return{state:null,username:"",tel:""}},computed:{subPanel(){switch(this.state){case"modify":return B;case"customer":return R;case"owner":return V;default:return null}}},methods:{logout(){v.user.logout().then(({success:e,message:s})=>{e?(console.log(">> "+s),this.$emit("logout")):console.log(">> logout failed: unknown error")})},switchPanel(e){this.state===e?this.state=null:this.state=e},getInfo(){v.user.getInfo().then(({user:e,error:s,message:o})=>{e?(console.log(">> get user info successfully"),{username:this.username,tel:this.tel}=e):console.log(s?">> get user info failed: "+o:">> get user info failed: unknown error")})}},emits:["logout"],created(){this.getInfo()}},Fe=e=>(y("data-v-9dbdeff4"),e=e(),I(),e),Ne={class:"info-panel border-panel"},Te=Fe(()=>t("img",{class:"avatar",src:C,alt:"avatar"},null,-1)),Ee={class:"base-info"},He={class:"username"},je={class:"tel"},Oe={class:"button-bar"},qe={class:"button-bar"};function ze(e,s,o,c,i,l){return a(),r(w,null,[t("div",Ne,[Te,t("div",Ee,[t("div",He,u(i.username),1),t("div",je,u(i.tel),1)]),t("div",Oe,[t("button",{onClick:s[0]||(s[0]=n=>l.switchPanel("modify")),class:S(["panel-button",{active:i.state==="modify"}])}," 修改个人信息 ",2),t("button",{onClick:s[1]||(s[1]=(...n)=>l.logout&&l.logout(...n)),class:"panel-button"},"退出登录")]),t("div",qe,[t("button",{onClick:s[2]||(s[2]=n=>l.switchPanel("customer")),class:S(["panel-button",{active:i.state==="customer"}])}," 我的预约 ",2),t("button",{onClick:s[3]||(s[3]=n=>l.switchPanel("owner")),class:S(["panel-button",{active:i.state==="owner"}])}," 我的房源 ",2)])]),(a(),b(N(l.subPanel),{username:i.username,onUpdate:l.getInfo,onChangePass:s[4]||(s[4]=n=>this.$emit("logout")),tel:i.tel},null,40,["username","onUpdate","tel"]))],64)}const Ge=d(Ae,[["render",ze],["__scopeId","data-v-9dbdeff4"]]),Je={emits:["login","logout"],data(){return{login:!1}},components:{LoginPanel:K,InfoPanel:Ge}},Ke={class:"user-panel"};function Qe(e,s,o,c,i,l){const n=f("LoginPanel"),h=f("InfoPanel");return a(),r("div",Ke,[i.login?_("",!0):(a(),b(n,{key:0,onLogin:s[0]||(s[0]=L=>{i.login=!0,this.$emit("login")})})),i.login?(a(),b(h,{key:1,onLogout:s[1]||(s[1]=L=>{i.login=!1,this.$emit("logout")})})):_("",!0)])}const We=d(Je,[["render",Qe]]);const Xe={methods:{h:T},props:["houseInfo"]},m=e=>(y("data-v-da992874"),e=e(),I(),e),Ye={class:"data-item"},Ze={class:"picture",hidden:""},es=m(()=>t("img",{src:C,alt:""},null,-1)),ss={class:"info"},ts={class:"name"},ns={key:0,class:"price"},os=m(()=>t("span",null,"价格：",-1)),is={key:1,class:"address"},ls=m(()=>t("span",null,"地址：",-1)),as={key:2,class:"area"},rs=m(()=>t("span",null,"面积：",-1)),us={key:3,class:"floor"},cs=m(()=>t("span",null,"楼层：",-1)),ds={key:4,class:"direction"},_s=m(()=>t("span",null,"朝向：",-1)),ps={key:5,class:"layout"},fs=m(()=>t("span",null,"布局：",-1)),ms={key:6,class:"developer"},hs=m(()=>t("span",null,"开发商：",-1)),vs={key:7,class:"has-elevator"},gs=m(()=>t("span",null,"电梯：",-1)),$s={key:8,class:"build-time"},bs=m(()=>t("span",null,"建成时间：",-1));function ys(e,s,o,c,i,l){return a(),r("div",Ye,[t("div",Ze,u(o.houseInfo.picture),1),es,t("div",ss,[t("div",ts,u(o.houseInfo.name),1),o.houseInfo.price?(a(),r("div",ns,[os,p(" "+u(o.houseInfo.price)+"元 ",1)])):_("",!0),o.houseInfo.address?(a(),r("div",is,[ls,p(" "+u(o.houseInfo.address),1)])):_("",!0),o.houseInfo.area?(a(),r("div",as,[rs,p(" "+u(o.houseInfo.area),1)])):_("",!0),o.houseInfo.floor?(a(),r("div",us,[cs,p(" "+u(o.houseInfo.floor),1)])):_("",!0),o.houseInfo.direction?(a(),r("div",ds,[_s,p(" "+u(o.houseInfo.direction),1)])):_("",!0),o.houseInfo.layout?(a(),r("div",ps,[fs,p(" "+u(o.houseInfo.layout),1)])):_("",!0),o.houseInfo.developer?(a(),r("div",ms,[hs,p(" "+u(o.houseInfo.developer),1)])):_("",!0),o.houseInfo.hasElevator!==null?(a(),r("div",vs,[gs,p(" "+u(o.houseInfo.hasElevator?"有":"无"),1)])):_("",!0),o.houseInfo.buildTime?(a(),r("div",$s,[bs,p(" "+u(o.houseInfo.buildTime),1)])):_("",!0)])])}const Is=d(Xe,[["render",ys],["__scopeId","data-v-da992874"]]),ws={props:["houses"],components:{DataItem:Is}},Ps={class:"data-list"};function xs(e,s,o,c,i,l){const n=f("DataItem");return a(),r("div",Ps,[t("ul",null,[(a(!0),r(w,null,k(o.houses,h=>(a(),b(n,{"house-info":h},null,8,["house-info"]))),256))])])}const ks=d(ws,[["render",xs]]),Ls={data(){}},Ss={class:"filter"},Ms=E('<div class="input-panel"><div class="label">价位</div><div class="input-line"><input type="number"><input type="number"></div><div class="input-line"><div class="label">建造时间</div><input type="number"><input type="number"></div><div class="input-line"><div class="label">面积</div><input type="number"><input type="number"></div><div class="input-line"><div class="label">楼层</div><input type="number"><input type="number"></div><fieldset class="input-line"><legend class="label">电梯</legend><input id="no-limit" name="elevator" type="radio"><label for="no-limit">不限</label><input id="ele_yes" name="elevator" type="radio"><label for="ele_yes">有</label><input id="ele_no" name="elevator" type="radio"><label for="ele_no">无</label></fieldset><div class="input-line"><div class="label">布局</div><select><option value=""></option><option value=""></option><option value=""></option><option value=""></option><option value=""></option></select></div></div><button>查询</button>',2),Us=[Ms];function Cs(e,s,o,c,i,l){return a(),r("div",Ss,Us)}const Ds=d(Ls,[["render",Cs]]);const Vs={data(){return{houses:[]}},components:{DataList:ks,FilterPanel:Ds},created(){v.user.getBrowseData().then(e=>{console.log(e),this.houses=e.houses})}},Bs=e=>(y("data-v-4d51c559"),e=e(),I(),e),Rs={class:"data-panel border-panel"},As=Bs(()=>t("div",{class:"title"},"房源",-1));function Fs(e,s,o,c,i,l){const n=f("DataList");return a(),r("div",Rs,[As,x(n,{houses:i.houses},null,8,["houses"])])}const Ns=d(Vs,[["render",Fs],["__scopeId","data-v-4d51c559"]]);const Ts={components:{UserPanel:We,BrowsePanel:Ns},data(){return{login:!1}}},D=e=>(y("data-v-bf40e295"),e=e(),I(),e),Es={class:"container"},Hs=D(()=>t("header",null,"HouseAnt",-1)),js={class:"content"},Os=["hidden"],qs=D(()=>t("button",{class:"router border-panel"},"数据管理",-1)),zs=[qs],Gs=D(()=>t("footer",null,"HouseAnt",-1));function Js(e,s,o,c,i,l){const n=f("UserPanel"),h=f("BrowsePanel");return a(),r("div",Es,[Hs,t("div",js,[x(n,{onLogin:s[0]||(s[0]=L=>i.login=!0),onLogout:s[1]||(s[1]=L=>i.login=!1)}),x(h)]),t("a",{hidden:!i.login,href:"/database/"},zs,8,Os),Gs])}const Ks=d(Ts,[["render",Js],["__scopeId","data-v-bf40e295"]]);H(Ks).mount("#app");
